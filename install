#!/usr/bin/bash

#according rpuntaie-meta on https://github.com/rpuntaie/rollarch

dotfilesurl=https://github.com/rpuntaie/dotfiles
cd ~

if [[ -d dotfiles ]]; then
  cd dotfiles
  if [[ ! "$(git config --get remote.origin.url)"=="$dotfilesurl" ]]; then
    echo "This install script is for a different dotfiles" >&2
    exit 1
  fi
  cd ..
else
  git clone $dotfilesurl
fi

if [[ -d .local ]]; then
  stow --no-folding -R -t .local dotfiles 
else
  mkdir .local
  stow --no-folding -S -t .local dotfiles 
fi
cd dotfiles
stow home
cd ..
ln -sf .local/etc/xmonad .xmonad
xmonad --recompile

if [[ -x /usr/bin/yay ]]; then
echo "Installing used AUR packages now"
yay -S --needed --noconfirm wordnet-cli
yay -S --needed --noconfirm waf-git
else
echo "No yay to install some used AUR packages"
fi

echo -e "\033[0;32mLog out and in, to activate the environment."
