#!/usr/bin/bash

#according rpuntaie-meta on https://github.com/rpuntaie/rollarch

dotfilesurl=https://github.com/rpuntaie/dotfiles
cd ~

if [[ -d dotfiles ]]; then
  cd dotfiles
  if [[ ! "$(git config --get remote.origin.url)"=="$dotfilesurl" ]]; then
    echo "This install script is for a different dotfiles" >&2
    exit 1
  fi
  cd ..
else
  #if .dotfiles exits: $new_install=true ~/dotfiles/install
  new_install=true
  git clone $dotfilesurl
fi

bash dotfiles/bin/restowdots
#mkdir -p $HOME/.ssh
#chmod 700 $HOME/.ssh
ln -sf .local/etc/xmonad .xmonad
xmonad --recompile

if $new_install; then
  fc-cache -fv
  pip install --user rstdoc #documentation
  #pip install --user sphinxcontrib-tikz #documentation
  ##pip install --user git+https://bitbucket.org/philexander/tikz\#egg=sphinxcontrib-tikz
  #pip install --user sphinxcontrib-texfigure #documentation
  #pip install --user sphinxcontrib-thm #documentation
  pip install --user autopep8 #used in vim to reformat
  pip install --user doit #automate using dodo.py file
  pip install --user when-changed #... file/dir -c command
  pip install --user astropy #science
  pip install --user pygame #graphics
  pip install --user bottle #web framework
  pip install --user cookiecutter #template projects
  pip install --user pymunk #2D physics engine
  yay -S --needed --noconfirm plantuml #for rstdoc
  yay -S --needed --noconfirm wordnet-cli #used in vim
  yay -S --needed --noconfirm waf-git #to build
  yay -S --needed --noconfirm rstudio-desktop-bin #for R: rstudio-bin
  yay -S --needed --noconfirm texlive-localmanager-git #for special tex packages
  yay -S --needed --noconfirm mimeo #default file opening besides rifle and xdg-open
  #FAILS with out of memory compiling: yay -S --needed --noconfirm nextpnr-git #FPGA place and route 
  #these depend on 32 bit packages
  #yay -S --needed --noconfirm openmodelica-git #modelica language
  #yay -S --needed --noconfirm quartus-free #for Altera FPGA's
  #yay -S --needed --noconfirm intel-sde #Intel Software Development Emulator
fi

echo -e "\033[0;32mLog out and in, to activate the environment."
