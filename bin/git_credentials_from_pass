#!/usr/bin/env bash

# assuming "get" action from git and a config like this
# git config --global credential.helper $XDG_BIN_HOME'/git_credentials_from_pass $@'
_github_=0
while IFS= read -r line
do
  echo "$line"
  if [[ "$line" =~ host=.*github.com.* ]]; then
    _github_=1
  fi
  if [[ $_github_ == 1 && "$line" =~ path=.* ]]; then
    if [[ "$line" =~ path=.*zeniqcore.* ]]; then
      echo "username=zeniqcore"
      echo "password=$(pass show token_github.com/zeniqcore)"
    elif [[ "$line" =~ path=.*zeniqsmart.* ]]; then
      echo "username=github2@zeniq.com"
      echo "password=$(pass show token_github.com/zeniqsmart)"
    else
      echo "username=rpuntaie"
      echo "password=$(pass show token_github.com/rpuntaie)"
    fi
    _github_=0
  fi
  if [[ "$line" =~ host=.*gitlab.vougee.gmbh.* ]]; then 
    echo "username=roland.puntaier"
    echo "password=$(pass show gitlab.vougee.gmbh/roland.puntaier)"
  elif  [[ "$line" =~ host=.*g.fastprj.tech.* ]]; then
    echo "username=roland.puntaier"
    echo "password=$(pass show g.fastprj.tech/roland.puntaier)"
  fi
done

